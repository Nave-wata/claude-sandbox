# Claude Sandbox

Claude Code を安全かつ一貫して異なるシステム上で実行するためのコンテナ化されたサンドボックス環境です。

## 概要

Claude Sandbox は、分離された実行環境、一貫した依存関係、自動ディレクトリマウントを備えた Claude Code のコンテナ化された環境を提供します。これは `claude` コマンドの純粋なラッパーとして動作し、すべての引数はコンテナ化された環境で実行される Claude Code に変更されることなく渡されます。

これにより、Claude Code は制御された環境で実行されながら、現在の作業ディレクトリへのアクセスを維持し、まったく同じコマンドラインインターフェースを保持できます。

## コンセプトと目的

### なぜ Claude Sandbox なのか？

- **分離**: Claude Code を制御されたコンテナ環境で実行
- **一貫性**: 異なるホストシステム間で同じランタイム環境
- **安全性**: コンテナ化された実行により追加のセキュリティレイヤーを提供
- **可搬性**: 異なるマシンや環境での簡単な展開
- **透明性**: 純粋なラッパー動作により馴染みのある Claude Code インターフェースを維持

### 設計原則

1. **純粋なラッパー**: Claude Code の動作に対するカスタムオプションや変更なし
2. **透明な操作**: すべての引数は Claude Code に変更されることなく渡される
3. **ディレクトリマウント**: 現在の作業ディレクトリが自動的にアクセス可能
4. **設定の永続化**: Claude の設定と認証が保持される
5. **マルチプラットフォームサポート**: 異なるオペレーティングシステムに対応可能な拡張構造

## 使用方法

`claude-sandbox` コマンドは通常の `claude` コマンドとまったく同じように動作します：

```bash
# インタラクティブな Claude Code CLI を開始（最も一般的な使用方法）
claude-sandbox

# 前回のセッションを再開
claude-sandbox --resume

# 特定のモデルで開始
claude-sandbox --model sonnet

# すべての Claude Code オプションがまったく同じように動作
claude-sandbox --help      # Claude Code のヘルプを表示
claude-sandbox --version   # Claude Code のバージョンを表示
```

**重要**: `claude-sandbox` は独自のヘルプやオプションを持ちません。すべてはコンテナ化された Claude Code インスタンスに渡されます。

## 動作方法

1. **純粋なラッパー**: `claude-sandbox` コマンドはすべての引数を変更せずにコンテナ化された Claude Code に渡します
2. **ディレクトリマウント**: 現在の作業ディレクトリは自動的にコンテナ内の `/workspace` にマウントされます
3. **設定の永続化**: Claude の設定（`~/.claude/`、`~/.claude.json`）は認証と設定を保持するためにマウントされます
4. **コンテナ管理**: コンテナイメージは初回使用時に構築され、その後の実行で再利用されます
5. **インタラクティブ CLI**: 引数なしで実行すると、コンテナ内で完全なインタラクティブ Claude Code CLI が開始されます

## プロジェクト構造

```
claude-sandbox/
├── README.md                           # このドキュメント（コンセプトと一般的な使用方法）
└── ubuntu/                             # OS固有の実装
    └── 24.04/                          # Ubuntu 24.04 実装
        ├── README.md                   # 実装固有のドキュメント
        ├── wizard.sh                   # セットアップおよび管理ウィザード
        ├── claude-sandbox              # メインラッパースクリプト
        └── sandbox/                    # コンテナ設定
            └── Dockerfile              # コンテナ定義
```

この構造により、`ubuntu/22.04/`、`alpine/3.18/` などの新しいディレクトリを追加することで、将来的に異なるオペレーティングシステムやバージョンをサポートできます。

## 利用可能な実装

### Ubuntu 24.04

asdfバージョンマネージャーサポート付きのNode.js 24.4-slimをベースイメージとして使用したDockerベースの実装です。

**インストール**: 詳細なインストールと使用方法については [`ubuntu/24.04/README.md`](ubuntu/24.04/README.md) を参照してください。

**機能**:
- Claude Code がプリインストールされた Node.js 環境
- マルチ言語開発サポートのためのasdfバージョンマネージャー
- `--plugins`オプションによる動的プラグイン設定
- 自動ディレクトリマウント
- 設定の永続化
- コミットSHA検証によるセキュリティ強化されたコンテナセットアップ
- 堅牢なエラーハンドリングと安定版バージョン優先設定

## オプションのエイリアス

便利なエイリアスを作成できます：

```bash
# ~/.bashrc に追加
alias claude='claude-sandbox'    # デフォルトの claude コマンドとして使用
alias cs='claude-sandbox'        # 短縮エイリアス
```

## 要件

- **コンテナランタイム**: Docker（現在の実装）
- **権限**: ユーザーがコンテナランタイムにアクセスできること
- **Claude Code ライセンス**: 有効な Claude Code 認証/ライセンス
